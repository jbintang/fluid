function [phi,res] = PoissonADI2P(phi,nx,ny,Ap,An,As,Ae,Aw,Q,w)

%% Kalkulasi Metode ADI
% Untuk penghitungan arah sumbu x
for j = 2:ny-1
    RHS1(2:nx-1) = (1-w).*Ap(2:nx-1,j).*phi(2:nx-1,j)...
        + w.*(-(An(2:nx-1,j).*phi(2:nx-1,j+1) ...
        + As(2:nx-1,j).*phi(2:nx-1,j-1)) + Q(2:nx-1,j));
    phi(2:nx-1,j) = tridiag(w.*Aw(2:nx-1,j),Ap(2:nx-1,j),w.*Ae(2:nx-1,j),RHS1(2:nx-1));
end

% Untuk penghitungan arah sumbu y
for i = 2:nx-1
    RHS2(2:ny-1) = (1-w).*Ap(i,2:ny-1).*phi(i,2:ny-1)...
        + w.*(-(Ae(i,2:ny-1).*phi(i+1,2:ny-1) ...
        + Aw(i,2:ny-1).*phi(i-1,2:ny-1)) + Q(i,2:ny-1));
    phi(i,2:ny-1) = tridiag(w.*As(i,2:ny-1),Ap(i,2:ny-1),w.*An(i,2:ny-1),RHS2(2:ny-1));
end

%% Penghitungan Residu
rho(2:nx-1,2:ny-1) = Q(2:nx-1,2:ny-1) ...
    - ( Ap(2:nx-1,2:ny-1).*phi(2:nx-1,2:ny-1) ...
    + An(2:nx-1,2:ny-1).*phi(2:nx-1,3:ny) ...
    + As(2:nx-1,2:ny-1).*phi(2:nx-1,1:ny-2) ...
    + Ae(2:nx-1,2:ny-1).*phi(3:nx,2:ny-1) ...
    + Aw(2:nx-1,2:ny-1).*phi(1:nx-2,2:ny-1));

res = sqrt(sum(sum(rho.^2))/sqrt(nx^2 + ny^2));
